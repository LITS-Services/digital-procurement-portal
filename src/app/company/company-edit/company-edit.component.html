<section>
  <div class="row">
    <div class="col-12">

      <!-- Header -->
      <div class="row mb-2">
        <div class="col-md-12">
          <h4 class="heading">Company Review</h4>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="card cstm-ui-card mb-2">
        <div class="row">
          <div class="col-md-6">
            <button class="btn btn-lg mr-1" type="button" (click)="goBack()">
              <i class="ft-arrow-left"></i>
            </button>
            <span class="vl"></span>

            <!-- <button class="btn btn-sm" [disabled]="!companyId" (click)="openRemarkModal(2, remarkModal)">
              <i class="fa fa-circle-check"></i> Approve
            </button>

            <button class="btn btn-sm" [disabled]="!companyId" (click)="openRemarkModal(4, remarkModal)">
              <i class="fa fa-rotate-left"></i> Recall
            </button> -->

            <!-- <button class="btn btn-sm cstm-ui-table-btn" [disabled]="!companyId"
                (click)="onActions('Approve')">
                <i class="ft-check"></i><label class="ml-1 mt-1">Approve</label>
              </button> -->


            <!-- If isAssigned = true → show Submit for Approval -->
            <button *ngIf="isAssigned" class="btn btn-sm cstm-ui-table-btn" [disabled]="!companyId"
              (click)="onActions('sendforapproval')">
              <i class="ft-check"></i>
              <label class="ml-1 mt-1">Submit for Approval</label>
            </button>

            <!-- If isAssigned = false → normal behavior -->
            <button *ngIf="!isAssigned" class="btn btn-sm cstm-ui-table-btn" [disabled]="!companyId"
              (click)="onActions('Approve')">
              <i class="ft-check"></i>
              <label class="ml-1 mt-1">Approve</label>
            </button>


            <button class="btn btn-sm cstm-ui-table-btn" [disabled]="!companyId" (click)="onActions('Rejected')">
              <i class="ft-x"></i><label class="ml-1 mt-1">Reject</label>
            </button>

            <button class="btn btn-sm cstm-ui-table-btn" [disabled]="!companyId" (click)="onActions('SendBack')">
              <i class="ft-arrow-left"></i><label class="ml-1 mt-1">Send Back</label>
            </button>

          </div>
        </div>
      </div>

  <div>

    <!-- Tabs navigation -->
    <div class="custom-tabs mb-1">
      <nav>
        <button
          (click)="selectTab('general-info')"
          [ngClass]="{ 'tab-current': selectedTab === 'general-info' }"
          class="custom-style-tab">
          <span>GENERAL INFORMATION</span>
        </button>

        <button
          (click)="selectTab('addresses')"
          [ngClass]="{ 'tab-current': selectedTab === 'addresses' }"
          class="custom-style-tab">
          <span>ADDRESSES</span>
        </button>

        <button
          (click)="selectTab('company-contacts')"
          [ngClass]="{ 'tab-current': selectedTab === 'company-contacts' }"
          class="custom-style-tab">
          <span>CONTACT</span>
        </button>

        <button
          (click)="selectTab('purchasing-demo')"
          [ngClass]="{ 'tab-current': selectedTab === 'purchasing-demo' }"
          class="custom-style-tab">
          <span>DEMOGRAPHICS</span>
        </button>

        <button
          (click)="selectTab('bank-details')"
          [ngClass]="{ 'tab-current': selectedTab === 'bank-details' }"
          class="custom-style-tab">
          <span>BANK</span>
        </button>

        <button
          (click)="selectTab('attachments')"
          [ngClass]="{ 'tab-current': selectedTab === 'attachments' }"
          class="custom-style-tab">
          <span>ATTACHMENTS</span>
        </button>

         <button
          (click)="selectTab('setup-history')"
          [ngClass]="{ 'tab-current': selectedTab === 'setup-history' }"
          class="custom-style-tab">
          <span>Setup History</span>
        </button>

         <button
          (click)="selectTab('approval-history')"
          [ngClass]="{ 'tab-current': selectedTab === 'approval-history' }"
          class="custom-style-tab">
          <span>Approval History</span>
        </button>
      </nav>
    </div>

    <!-- TAB CONTENTS -->

      <div *ngIf="selectedTab === 'general-info'">
        <div class="card mt-0 p-3 company-profile">

          <!-- Top: company header -->
          <div class="d-flex align-items-center mb-3">
            <div class="company-avatar mr-3">
              <i class="ft-briefcase"></i>
            </div>

            <div class="flex-grow-1">
              <div class="company-label text-uppercase">Company Name</div>

              <div class="d-flex flex-wrap align-items-center">
                <h3 class="mb-0 mr-2 company-title">{{ companyName }}</h3>

                <span class="company-status-pill"
                  [ngClass]="companyStatusClass"
                   *ngIf="companyStatusLabel"
                >
                  <span class="status-dot"></span>
                          {{ companyStatusLabel | uppercase }}
                </span>
              </div>
            </div>
          </div>

          <hr />

          <!-- Associated entities header -->
          <div class="d-flex justify-content-between align-items-center mb-1">
            <div class="d-flex align-items-center">
              <h5 class="mb-0 mr-2">Associated Entities</h5>
              <span class="badge badge-light rounded-pill">
                {{ associatedEntities.length }}
              </span>
            </div>
          </div>

          <p class="text-muted small mb-3">
            Subsidiaries and business units operating under this parent company.
          </p>

          <!-- Entity list -->
          <div class="entity-card mb-2" *ngFor="let entity of associatedEntities">
            <div class="d-flex align-items-center justify-content-between">
              <!-- Left: icon + name + meta -->
              <div class="d-flex align-items-center">
                <div class="entity-avatar mr-3 entity-avatar--blue" >
                  <i class="fa fa-building"></i>
                </div>

                <div>
                  <div class="entity-name">{{ entity.name }}</div>
                  <!-- <div class="entity-meta text-muted small">
                    <i class="ft-map-pin mr-1"></i>
                    {{ entity.city }}, {{ entity.country }}
                    <span class="mx-1">•</span>
                    {{ entity.industry }}
                  </div> -->
                </div>
              </div>

              <!-- Right: status + chevron -->
              <div class="d-flex align-items-center">
                <span class="entity-status-pill" [ngClass]="entity.statusClass">
                  {{ entity.statusLabel }}
                </span>
              
              </div>
            </div>
          </div>
        </div>
      </div>

    <!-- Addresses -->
    <div *ngIf="selectedTab === 'addresses'">
      <ngx-datatable
        [columnMode]="'force'"
        *ngIf="addressList && addressList.length > 0"
        class="bootstrap"
        [rows]="addressList"
        [headerHeight]="50"
        [footerHeight]="50"
        [rowHeight]="'auto'"
        [limit]="5">

        <ngx-datatable-column [sortable]="false" name="Street" prop="street"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="City" prop="city"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="State" prop="state"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Zip" prop="zip"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Country" prop="country"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Primary">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <i
              style="font-size: 20px;"
              class="fa"
              [ngClass]="{
                'fa-circle-check': row.isPrimary === true,
                'fa-circle-xmark': row.isPrimary === false
              }"></i>
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>
    </div>

    <!-- Company Contact Details -->
    <div *ngIf="selectedTab === 'company-contacts'">
      <ngx-datatable
        [columnMode]="'force'"
        *ngIf="contactList && contactList.length > 0"
        class="bootstrap"
        [rows]="contactList"
        [headerHeight]="50"
        [footerHeight]="50"
        [rowHeight]="'auto'"
        [limit]="5">

        <ngx-datatable-column [sortable]="false" name="Description" prop="description"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Type" prop="type"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Contact Number" prop="contactNumber"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Extension" prop="extension"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Primary">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <i
              style="font-size: 20px;"
              class="fa"
              [ngClass]="{
                'fa-circle-check': row.isPrimary === true,
                'fa-circle-xmark': row.isPrimary === false
              }"></i>
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>
    </div>

    <!-- Purchasing Demographics -->
    <div *ngIf="selectedTab === 'purchasing-demo'">
      <ngx-datatable
        [columnMode]="'force'"
        *ngIf="purchasingDemographicsList && purchasingDemographicsList.length > 0"
        class="bootstrap"
        [rows]="purchasingDemographicsList"
        [headerHeight]="50"
        [footerHeight]="50"
        [rowHeight]="'auto'"
        [limit]="5">

        <ngx-datatable-column [sortable]="false" name="Vendor Type" prop="vendorType"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Primary Currency" prop="primaryCurrency"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Line of Business" prop="lineOfBusiness"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Employee Responsible" prop="employeeResponsible"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Note" prop="note"></ngx-datatable-column>
      </ngx-datatable>
    </div>

    <!-- Bank Details -->
    <div *ngIf="selectedTab === 'bank-details'">
      <ngx-datatable
        *ngIf="bankDetailsList && bankDetailsList.length > 0"
        class="bootstrap"
        [rows]="bankDetailsList"
        [headerHeight]="50"
        [footerHeight]="50"
        [rowHeight]="'auto'"
        [limit]="5"
        [columnMode]="'force'">

        <ngx-datatable-column [sortable]="false" name="Bank Name" prop="bankName"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Branch Name" prop="branchName"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Branch Address" prop="branchAddress"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Account Holder" prop="accountHolderName"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Account Number" prop="accountNumber"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="IBAN" prop="iban"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="SWIFT/BIC" prop="swifT_BIC_Code"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Country" prop="country"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Currency" prop="currency"></ngx-datatable-column>
      </ngx-datatable>
    </div>

    <!-- Attachments -->
    <div *ngIf="selectedTab === 'attachments'">
      <ngx-datatable
        *ngIf="attachedFiles && attachedFiles.length > 0"
        class="bootstrap"
        [rows]="attachedFiles"
        [headerHeight]="50"
        [footerHeight]="50"
        [rowHeight]="'auto'"
        [limit]="5"
        [columnMode]="'force'">

        <ngx-datatable-column [sortable]="false" name="File Name" prop="fileName"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Format" prop="format"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Attached By" prop="attachedBy"></ngx-datatable-column>
        <ngx-datatable-column [sortable]="false" name="Remarks" prop="remarks"></ngx-datatable-column>

        <ngx-datatable-column [sortable]="false" name="Attached At" prop="attachedAt">
          <ng-template let-value="value" ngx-datatable-cell-template>
            {{ value | date:'medium' }}
          </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column [sortable]="false" name="Action">
          <ng-template let-row="row" ngx-datatable-cell-template>
            <i
              (click)="downloadAttachment(row)"
              class="fa fa-circle-down"
              style="font-size: 20px; cursor:pointer"></i>
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>

      <div *ngIf="attachedFiles && attachedFiles.length === 0" class="text-muted p-2">
        No attachments found.
      </div>
    </div>

    <div *ngIf="selectedTab === 'approval-history'">
      <app-company-approval-history [ProcurementCompanyId]="procurementCompanyId" [vendorComapnyId]="companyId"></app-company-approval-history>
    </div>

    <div *ngIf="selectedTab === 'setup-history'">
      <app-company-setup-history [vendorEntityAssociationId]="vendorEntityAssociationId" [vendorComapnyId]="companyId"></app-company-setup-history>
    </div>

  </div>
    </div>

<!-- Remark Modal (unchanged) -->
<ng-template #remarkModal let-modal>
  <!-- your existing modal code -->
</ng-template>

</div>

</section>