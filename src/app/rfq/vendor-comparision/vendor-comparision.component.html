<div class="modal-header">
  <h4 class="modal-title text-white">Vendor Comparison</h4>
  <button type="button" class="close text-white" aria-label="Close" (click)="closeDialog()">
    <span aria-hidden="true">&times;</span>
  </button>
</div>

<div class="modal-body">
  <h4 class="mb-3">Final Vendors</h4>

  <div class="form-row">
    <!-- Commented as requested -->

    <!-- <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
      <div class="form-group mb-2">
        <label>Item Code</label>
        <input type="text" placeholder="GS-DPD009" disabled class="form-control" />
      </div>
    </div> -->
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
      <div class="form-group">
        <label for="">Item Code</label>
        <select class="form-control" [(ngModel)]="selectedItemCode" (change)="applyVendorItemFilter()">
          <option *ngFor="let item of vendorComparisonList" [value]="item.itemCode">
            {{ item.itemCode }} - {{ item.itemDescription }}
          </option>
        </select>
      </div>
    </div>


    <!-- <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
      <div class="form-group">
        <label for="">Vendor</label>
        <select name="" id="" class="form-control">
          <option value="null">Select Final Vendor</option>
          <option value="">AFI Flight Inspection GmbH</option>
          <option value="">Atlas Safety Products</option>
          <option value="">AudiViz Technologies</option>
        </select>
      </div>
    </div> -->
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
      <div class="form-group">
        <label for="">Vendor</label>
        <select class="form-control" [(ngModel)]="selectedVendorId" (change)="applyVendorItemFilter()">
          <option *ngFor="let v of vendors" [value]="v.vendorUserId">
            {{ v.vendorName }}
          </option>
        </select>
      </div>
    </div>


    <div class="col-12">
      <div class="form-group">
        <label for="">Description</label>
        <textarea name="" id="" rows="5" placeholder="Enter Description" class="form-control"></textarea>
      </div>
    </div>
  </div>

  <hr class="my-4" />
  <h4 class="mb-3">Vendor Quotations</h4>

  <!-- ðŸ”¥ Dynamic accordion loop -->
  <div *ngIf="filteredVendorComparisonList.length > 0; else noBids"></div>
  <ngb-accordion #accordion="ngbAccordion" *ngFor="let item of filteredVendorComparisonList; let i = index"
    [activeIds]="'ngb-panel-' + i">
    <ngb-panel [id]="'ngb-panel-' + i">
      <ng-template ngbPanelTitle>
        <div class="row">
          <div class="col-md-6">
            <span class="panel-icon">
              <!-- Item Code from backend -->
              <label class="text-white"> Item No: {{ item.itemCode }} - {{ item.itemDescription }}</label>
              <span class="spacer"></span>
              <i class="ft-chevron-down"></i>
            </span>
          </div>
        </div>
      </ng-template>

      <ng-template ngbPanelContent>
        <ngx-datatable class="bootstrap core-bootstrap" [rows]="item.vendorComparisonBid" [columnMode]="'standard'"
          [headerHeight]="50" [footerHeight]="40" [rowHeight]="60" [scrollbarH]="true"
          style="border: 1px solid #dee2e6; border-radius: 6px;">
          <!-- <ngx-datatable-column name="Vendor ID" prop="vendorUserId"></ngx-datatable-column> -->
          <ngx-datatable-column name="Vendor Name" prop="vendorName"></ngx-datatable-column>
          <ngx-datatable-column name="Amount" prop="biddingAmount"></ngx-datatable-column>
          <ngx-datatable-column name="Comment" prop="comment"></ngx-datatable-column>
          <ngx-datatable-column name="Action" [sortable]="false">
            <ng-template ngx-datatable-cell-template let-row="row">
              <button class="btn btn-sm mr-1" (click)="printVendor(row)">
                <i class="ft-printer"></i>
              </button>
            </ng-template>
          </ngx-datatable-column>
        </ngx-datatable>
      </ng-template>
    </ngb-panel>
  </ngb-accordion>
</div>
<ng-template #noBids>
  <div class="alert alert-warning text-center mt-3">
    No bid found for the selected item and vendor.
  </div>
</ng-template>
